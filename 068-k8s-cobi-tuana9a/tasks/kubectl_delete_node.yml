- name: delete kubernetes node
  become: true
  ansible.builtin.command: >
    kubectl delete node {{ k8s_node_name }}
  register: kubectl_delete_node_result
  environment:
    KUBECONFIG: "{{ kubeconfig | default('/etc/kubernetes/admin.conf') }}"
  changed_when: kubectl_delete_node_result.rc == 0
  failed_when: kubectl_delete_node_result.rc != 0

- name: delete kubernetes node [stdout]
  debug:
    msg: "{{ kubectl_delete_node_result.stdout | split('\n') }}"

- name: delete kubernetes node [stderr]
  debug:
    msg: "{{ kubectl_delete_node_result.stderr | split('\n') }}"
